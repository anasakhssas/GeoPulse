FROM bitnami/spark:3.4

USER root

# Install Python packages
RUN pip install --no-cache-dir \
    psycopg2-binary \
    watchdog \
    pandas \
    numpy

# Set working directory
WORKDIR /app

# Copy application files
COPY . /app/

# Make the processor script executable
RUN chmod +x /app/data_processor.py

USER 1001

# Run the data processor
CMD ["python", "/app/data_processor.py"]